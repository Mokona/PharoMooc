'From Pharo4.0 of 18 March 2013 [Latest update: #40622] on 6 October 2015 at 11:52:38.134367 am'!!ZnStaticFileServerDelegate methodsFor: 'public' stamp: 'Luc 10/6/2015 11:35'!handleRequest: request	"Server delegate entry point"	| actualFilename |	(#(#GET #HEAD) includes: request method)		ifFalse: [ ^ ZnResponse methodNotAllowed: request ].	actualFilename := self actualFilenameFor: request uri.	^ actualFilename notNil		ifTrue: [ 			(self redirectNeededFor: request uri actualFilename: actualFilename)				ifTrue: [ self directoryRedirectFor: request uri ]				ifFalse: [ self responseForFile: actualFilename fromRequest: request ] ]		ifFalse: [ 			self listFilesIfValidDirectory: request uri]! !!ZnStaticFileServerDelegate methodsFor: 'private' stamp: 'Luc 10/6/2015 11:46'!listFilesIfValidDirectory: uri	(self directory / uri asString) isDirectory ifFalse: [		  ^ ZnResponse notFound: uri ].		^ZnResponse ok: (ZnEntity html: (self htmlListingForURI: uri) )	! !!ZnStaticFileServerDelegate methodsFor: 'private' stamp: 'Luc 10/6/2015 11:50'!htmlListingForURI: uri	|baseURI|		baseURI := uri asString.	baseURI last ~= $/ ifTrue: [ baseURI := baseURI, '/' ].				^ String streamContents: [ :s | 		s << '<html><body><ul>'.		(self directory / uri asString) entries do: [ :e | 			s << '<li><a href="' << (baseURI, e basename) << '">' << e basename << '</a></li>' ].		s << '</ul></body></html>'.	]! !